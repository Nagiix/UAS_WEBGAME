<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Mirror Dungeon Style Map</title>

  <!-- ‚úÖ Load jQuery before anything else that uses it -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<!-- ‚úÖ DataTables CSS -->
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">

<!-- ‚úÖ DataTables JS -->
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>

  <!-- ‚úÖ Then Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- ‚úÖ Then your scripts that use jQuery -->
  <script type="module" src="./layout.js"></script>

  <style>
    html, body {
      margin: 0;
      height: 100%;
      overflow: hidden;
    }
    #cy {
      height: 100vh;
      width: 100%;
      background-color: #1d1a1a;
      cursor: grab;
    }
    .modal-backdrop.show {
      opacity: 0.9;
    }
  </style>
</head>

<body>
<script>
  console.log('HTML loaded before layout.js');
</script>
    <div class="main-content">
        <!-- Difficulty Modal -->
        <div class="modal show" id="difficultyModal" tabindex="-1" style="display: block; background-color: rgba(240,240,240,0.4);">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content text-bg-dark">
                    <div class="modal-header">
                        <h5 class="modal-title">Choose Difficulty</h5>
                    </div>
                    <div class="modal-body">
                        <div class="row row-cols-2 row-cols-md-4 g-2 text-center">
                            <button class="btn btn-success" onclick="player.difficulty = 1; startGame(Math.floor(Math.random() * 20) + 30, player.difficulty)">Easy<br>(nodes, 1 levels)</button>
                            <button class="btn btn-primary" onclick="player.difficulty = 2; startGame(Math.floor(Math.random() * 20) + 30, player.difficulty)">Medium<br>(nodes, 2 levels)</button>
                            <button class="btn btn-warning" onclick="player.difficulty = 3; startGame(Math.floor(Math.random() * 20) + 30, player.difficulty)">Hard<br>(nodes, 3 levels)</button>
                            <button class="btn btn-danger" onclick="player.difficulty = 5; startGame(Math.floor(Math.random() * 20) + 30, player.difficulty)">Impossible<br>(nodes, 5 levels)</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
<!-- ... same as before ... -->
<!-- Confirm Move Modal -->
    <div class="modal fade" id="confirmMoveModal" tabindex="-1">
        <div class="modal-dialog modal-sm modal-dialog-centered">
            <div class="modal-content text-dark">
                <div class="modal-body text-center">
                    <p>Move to next layer?</p>
                    <div class="d-flex justify-content-center gap-2">
                    <button type="button" id="confirmMoveYes" class="btn btn-primary btn-sm">Yes</button>
                    <button type="button" id="confirmMoveNo" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">No</button>
                    </div>
                </div>
            </div>
        </div>
    </div>


<!-- Cytoscape container -->
    <div id="cy">
        <div id="node-preview" style="
        position: absolute;
        top: 10px;
        right: 10px;
        color: white;
        padding: 10px 15px;
        border-radius: 8px;
        border: 2px solid #ffa500;
        font-size: 16px;
        display: none;
        z-index: 999;
        max-width: 200px;
        ">
        <strong>Node Preview</strong>
        <div id="preview-content"></div>
    </div>
    </div>

    <!-- Node Preview Panel -->
    
    <!-- Scripts -->
    <script src="https://unpkg.com/cytoscape@3.23.0/dist/cytoscape.min.js"></script>
    <script type="module" src="map.js"></script>
    <script type="module" src="./scripts/encounter_logics/enemy.js"></script>
    <script type="module" src="./scripts/player.js"></script>
    </div>
<div class="modal fade" id="winModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content bg-dark text-white">
      <div class="modal-header">
        <h5 class="modal-title">üéâ You Won!</h5>
      </div>
      <div class="modal-body">
        <h6>üìä Player Stats</h6>
        <ul id="win-stats" class="list-group list-group-flush mb-3"></ul>

        <h6>üéí Inventory</h6>
        <ul id="win-inventory" class="list-group list-group-flush mb-3"></ul>

        <h6>üìò Skills</h6>
        <ul id="win-skills" class="list-group list-group-flush mb-3"></ul>

        <h6>üíé Relics</h6>
        <ul id="win-relics" class="list-group list-group-flush"></ul>
      </div>
      <div class="modal-footer">
<button class="btn btn-primary" onclick="restartGame()">Play¬†Again</button>
      </div>
    </div>
  </div>
</div>
<!-- ‚úÖ Login Modal -->
<div class="modal fade" id="loginModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content text-bg-dark">
      <div class="modal-header">
        <h5 class="modal-title">üîê Login</h5>
      </div>
      <div class="modal-body">
        <input type="text" id="username" class="form-control mb-2" placeholder="Username">
        <input type="password" id="password" class="form-control mb-3" placeholder="Password">

        <!-- Centered Login Button -->
        <div class="d-flex justify-content-center mb-2">
          <button id="loginBtn" class="btn btn-primary px-4">Login</button>
        </div>

        <!-- Right-aligned Register Button -->
        <div class="d-flex justify-content-end">
          <button class="btn btn-link text-secondary small" id="registerBtn">Don't have an account? Register</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ‚úÖ Login Success Modal -->
<div class="modal fade" id="loginSuccessModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content bg-dark text-white">
      <div class="modal-header">
        <h5 class="modal-title">‚úÖ Login Successful</h5>
      </div>
      <div class="modal-body">
        <p id="loginSuccessMessage">Welcome, <strong>Player</strong>!</p>
      </div>
      <div class="modal-footer">
        <button type="button" id="continueBtn" class="btn btn-primary" data-bs-dismiss="modal">Continue</button>
      </div>
    </div>
  </div>
</div>
<!-- ‚úÖ Register Modal -->
<div class="modal fade" id="registerModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content bg-dark text-white">
      <div class="modal-header">
        <h5 class="modal-title">üìù Register New Account</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="mb-3">
          <label for="regUsername" class="form-label">Username</label>
          <input type="text" class="form-control" id="regUsername" placeholder="Enter username">
        </div>
        <div class="mb-3">
          <label for="regPassword" class="form-label">Password</label>
          <input type="password" class="form-control" id="regPassword" placeholder="Enter password">
        </div>
        <div class="mb-3">
          <label for="regNickname" class="form-label">Nickname</label>
          <input type="text" class="form-control" id="regNickname" placeholder="Enter nickname">
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" id="submitRegister" class="btn btn-primary">Register</button>
      </div>
    </div>
  </div>
</div>
<!-- ‚úÖ Login Modal -->
<div class="modal fade" id="loginModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content text-bg-dark">
      <div class="modal-header">
        <h5 class="modal-title">üîê Login</h5>
      </div>
      <div class="modal-body">
        <input type="text" id="username" class="form-control mb-2" placeholder="Username">
        <input type="password" id="password" class="form-control mb-3" placeholder="Password">

        <!-- Centered Login Button -->
        <div class="d-flex justify-content-center mb-2">
          <button id="loginBtn" class="btn btn-primary px-4">Login</button>
        </div>

        <!-- Right-aligned Register Button -->
        <div class="d-flex justify-content-end">
          <button class="btn btn-link text-secondary small" id="registerBtn">Don't have an account? Register</button>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="scoreboardModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content bg-dark text-white">
      <div class="modal-header">
        <h5 class="modal-title">üèÜ Top Scores</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <ul id="scoreboard-list" class="list-group list-group-flush"></ul>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="loseModal" tabindex="-1">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content bg-dark text-white">
      <div class="modal-header">
        <h5 class="modal-title">You Lost!</h5>
      </div>
      <div class="modal-body">
        <h6>Stats:</h6>
        <ul id="lose-stats" class="list-group mb-3"></ul>
        <h6>Inventory:</h6>
        <ul id="lose-inventory" class="list-group mb-3"></ul>
        <h6>Skills:</h6>
        <ul id="lose-skills" class="list-group mb-3"></ul>
        <h6>Relics:</h6>
        <ul id="lose-relics" class="list-group mb-3"></ul>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="restartGame()">Play Again</button>
      </div>
    </div>
  </div>
</div>

</body>
</html>
